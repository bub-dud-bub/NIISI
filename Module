#include <stdio.h>
#include <time.h>
#include <sys/time.h>
#include <math.h>
int q = 16807;
int m = 0x7fffffff;
long int seed;
double gen(int a, int b){
    a *= 10;
    b *= 10;
    double v;
    if (seed==0){
      seed = time(0);
    }
    do{
      seed = seed * q % m;
      v = (seed%(b+1-a)+a);
    }
    while(v<a||v>b);
    return v/10.0;
}
double gen2(double a, double b){
    double x;
    double y;
    double s;
    double z0;
    double z1;
    double S;
    if (seed==0){
      seed = time(0);
    }
    do{
      seed = seed * q % m;
      x = seed%1000000/1000000.0;
      seed = (seed * q % m);
      y = seed%1000000/1000000.0;
      z0 = cos(2.0*M_PI*y)*sqrt(-2.0*log(x));
      z1 = sin(2.0*M_PI*y)*sqrt(-2.0*log(x));
      z0 = z0*((b-a)/7.5) + a+(b-a)/2;
      if (z0>b||z0<a){
         z0 = z1;
         z0 = z0*((b-a)/7.5) + a+(b-a)/2;
      }
    }
    while(z0>b||z0<a);
    return z0;
}

void rectangle(int a, int b, int c, int d, double* x, double* y){
  a *= 10;
  b *= 10;
  c *= 10;
  d *= 10;
  if (seed==0){
    seed = time(0);
  }
  do{
    seed = seed * q % m;
    *x = (seed%(b+1-a)+a);
    seed = seed * q % m;
    *y = (seed%(d+1-c)+c);
  }
  while(*x<a||*x>b||*y<c||*y>d);
  *x /= 10;
  *y /= 10;
}

void rectangle2(int a, int b, int c, int d, double* x, double* y){
  double X;
  double Y;
  double s;
  double z0;
  double z1;
  double S;
  if (seed==0){
    seed = time(0);
  }
  do{
    do{
      seed = seed * q % m;
      X = seed%1000000/1000000.0;
      seed = (seed * q % m);
      Y = seed%1000000/1000000.0;
    }
    while(X<0||Y<0);
    z0 = cos(2.0*M_PI*Y)*sqrt(-2.0*log(X));
    z1 = sin(2.0*M_PI*Y)*sqrt(-2.0*log(X));
    z0 = z0*((b-a)/7.5) + a+(b-a)/2;
    z1 = z1*((d-c)/7.5) + c+(d-c)/2;
  }
  while(z0>b||z0<a||z1>d||z1<c);
  *x = z0;
  *y = z1;
}

void circle(int a, double* x, double* y){
  a *= 10;
  int b = a - a*2;
  double v;
  double w;
  if (seed==0){
    seed = time(0);
  }
  do{
    seed = seed * q % m;
    v = seed%((a+10-b))+b;
    seed = seed * q % m;
    w = seed%(a+10-b);
  }
  while(sqrt(v*v+w*w)>a);
  *x = v / 10.0;
  *y = w / 10.0;

}

void circle2(int a, double* x, double* y){
  a *= 10;
  int b = a - a*2;
  double v;
  double w;
  double X;
  double Y;
  if (seed==0){
    seed = time(0);
  }
  do{
    do{
      seed = seed * q % m;
      X = seed%1000000/1000000.0;
      seed = (seed * q % m);
      Y = seed%1000000/1000000.0;
    }
    while(X<0||Y<0);
    v = cos(2.0*M_PI*Y)*sqrt(-2.0*log(X));
    w = sin(2.0*M_PI*Y)*sqrt(-2.0*log(X));
    v = v*((a-b)/7.5);
    w = w*((a-b)/7.5);
  }
  while(v>a||v<b||w>a||w<b||sqrt(v*v+w*w)>a);
  *x = v / 10.0;
  *y = w / 10.0;
}

void paraped(int a, int b, int c, int d, int e, int f, double* x, double* y, double* z){
  a *= 10;
  b *= 10;
  c *= 10;
  d *= 10;
  e *= 10;
  f *= 10;
  if (seed==0){
    seed = time(0);
  }
  do{
    seed = seed * q % m;
    *x = (seed%(b+1-a)+a);
    seed = seed * q % m;
    *y = (seed%(d+1-c)+c);
    seed = seed * q % m;
    *z = (seed%(f+1-e)+e);
  }
  while(*x<a||*x>b||*y<c||*y>d||*z<e||*z>f);
  *x /= 10;
  *y /= 10;
  *z /= 10;
}

void paraped2(int a, int b, int c, int d, int e, int f, double* x, double* y, double* z){
  double X;
  double Y;
  double Z;
  double s;
  double z0;
  double z1;
  double z2;
  double S;
  if (seed==0){
    seed = time(0);
  }
  do{
    do{
      seed = seed * q % m;
      X = seed%1000000/1000000.0;
      seed = (seed * q % m);
      Y = seed%1000000/1000000.0;
      seed = (seed * q % m);
      Z = seed%1000000/1000000.0;
    }
    while(X<0||Y<0||Z<0);
    z0 = cos(2.0*M_PI*Y)*sqrt(-2.0*log(X));
    z1 = sin(2.0*M_PI*Y)*sqrt(-2.0*log(X));
    z2 = cos(2.0*M_PI*Z)*sqrt(-2.0*log(X));
    z0 = z0*((b-a)/7.5) + a+(b-a)/2;
    z1 = z1*((d-c)/7.5) + c+(d-c)/2;
    z2 = z2*((f-e)/7.5) + e+(f-e)/2;
  }
  while(z0>b||z0<a||z1>d||z1<c||z2>f||z2<e);
  *x = z0;
  *y = z1;
  *z = z2;
}

void ball(int a, int sign, double* x, double* y, double* z){
  sign = pow(10, sign);
  a *= sign;
  int b = a - a*2;
  double v;
  double w;
  double k;
  if (seed==0){
    seed = time(0);
  }
  do{
    seed = seed * q % m;
    v = seed%((a+sign-b))+b;
    seed = seed * q % m;
    w = seed%(a+sign-b);
    seed = seed * q % m;
    k = seed%(a+sign-b);
  }
  while(sqrt(v*v+w*w)>a||sqrt(v*v+k*k)>a||sqrt(k*k+w*w)>a);
  *x = v / sign;
  *y = w / sign;
  *z = k / sign;
}

void ball2(int a, int sign, double* x, double* y, double* z){
  sign = pow(10, sign);
  a *= sign;
  int b = a - a*2;
  double v;
  double w;
  double k;
  double X;
  double Y;
  double Z;
  if (seed==0){
    seed = time(0);
  }
  do{
    do{
      seed = seed * q % m;
      X = seed%1000000/1000000.0;
      seed = (seed * q % m);
      Y = seed%1000000/1000000.0;
      seed = (seed * q % m);
      Z = seed%1000000/1000000.0;
    }
    while(X<0||Y<0||Z<0);
    v = cos(2.0*M_PI*Y)*sqrt(-2.0*log(X));
    w = sin(2.0*M_PI*Y)*sqrt(-2.0*log(X));
    k = cos(2.0*M_PI*Z)*sqrt(-2.0*log(X));
    v = v*((a-b)/7.5);
    w = w*((a-b)/7.5);
    k = k*((a-b)/7.5);
  }
  while(v>a||v<b||w>a||w<b||sqrt(v*v+w*w)>a||sqrt(v*v+k*k)>a||sqrt(k*k+w*w)>a);
  *x = v / sign;
  *y = w / sign;
  *z = k / sign;
}
int main(void){
  printf("%f\n", gen(-6,234));
  double x;
  double y;
  double z;
  ball2(56, 2, &x, &y, &z);
  printf("%f\t%f\t%f\n", x, y, z);
  FILE *fp3=NULL;
  fp3=fopen("gen1.txt","w");
  for(int i=1;i<=10000;i++){
    ball2(56, 2, &x, &y, &z);
    fprintf(fp3,"%f\t%f\t%f\n", x, y, z);
  }
  return 0;


}
